* Localization

If you need to update the translations in the UI, you have two ways to
do that, globally or locally for a single site.

** Global

GNU gettext message catalogues (.po files) are located at
lib/AmuseWikiFarm/I18N/xx.po, where xx is the language code. Changes
done here shouldn't be site specific and if you improve the
translations, please send the updated .po file to me
(melmothx@gmail.com) or fork the amusewiki repo and do a pull request,
making sure you're aligned to the latest master branch.

** Local PO files

You can override the UI translations and provide them for the
categories as well (if your site is multilingual or if you use codes
instead of strings) storing the relevant po files into the "locales"
directory in the site repository (e.g. repo/amw/locales/hr.po).

** Legacy lexicon.json

Before version 1.8, the way to override the translation was using a
JSON file in the site_files/lexicon.json file.

The format was as follows (plain JSON):

  {
     "term" : {
        "hr" : "Term in croatian",
        "en" : "Term in english",
        "it" : "Term in italian"
     },
     "another term [_1]" : {
        "hr" : "Another term in croatian with an argument [_1]",
        "en" : "Another term in english with an argument [_1]",
        "it" : "Another term in italian with an argumetn [_1]"
     }
  }

The JSON must be correct, otherwise you will not get any translation
out of that. You can use arguments for translations with the [_1],
[_2] syntax (while the po files use %1, %2, etc.).

Strings are expected to be unescaped (html-wise).

To validate the lexicon file prior to upload, use this (somehow
longish) one-liner:

perl -MJSON -MData::Dumper \
     -e 'open (my $fh, "<:encoding(UTF-8)", "site_files/lexicon.json");
         $/ = undef; my $json = <$fh>;
            print Data::Dumper::Dumper(JSON::from_json($json));'

You can create the po files out of those files with the script
amusewiki-upgrade-lexicon. E.g.

script/amusewiki-upgrade-lexicon repo/*

Which will parse the lexicon.json files and dump the po files. Beware
that the committing is left to you.

